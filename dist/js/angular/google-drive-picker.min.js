if("undefined"==typeof CONFIG)var CONFIG={GOOGLE_CLIENT_ID:"614513768474.apps.googleusercontent.com"};if("undefined"==typeof RiseVision)var RiseVision={Authorization:{}};!function(e,i,o){"use strict";o.Authorization=function(){function o(o,t,n){i.auth.authorize({client_id:e.GOOGLE_CLIENT_ID,scope:t,immediate:o},function(e){e&&!e.error?r=e.access_token:window.console&&console.info("Authorization Fail: "+e.error),n.call(null,r)})}function t(){return a}function n(e){i.load("auth",{callback:function(){a=!0,"function"==typeof e&&e.apply(null)}})}function c(){return r}var r=null,a=!1;return{authorize:o,getAuthToken:c,isApiLoaded:t,loadApi:n}}()}(CONFIG,gapi,RiseVision),function(e){"use strict";var i=e.Authorization,o="https://www.googleapis.com/auth/drive";angular.module("risevision.widget.common.google-drive-picker",[]).directive("googleDrivePicker",["$document","$window","$log","$templateCache",function(e,t,n,c){return{restrict:"E",scope:{viewId:"@"},template:c.get("google-drive-picker-template.html"),link:function(c,r,a){function l(){function e(e){e[s.picker.Response.ACTION]===s.picker.Action.PICKED?(n.debug("Files picked",e[s.picker.Response.DOCUMENTS]),c.$emit("picked",e[s.picker.Response.DOCUMENTS])):e[s.picker.Response.ACTION]===s.picker.Action.CANCEL&&(n.debug("File pick cancelled"),c.$emit("cancel"))}function a(){var o,n,c=u.createElement("a");u.referrer?(c.href=u.referrer,o=c.protocol+"//"+c.hostname):o=t.location.protocol+"//"+t.location.host,k&&i.getAuthToken()&&(n=(new s.picker.PickerBuilder).setOrigin(o).addView(g[d]).setOAuthToken(i.getAuthToken()).setCallback(e).build(),n.setVisible(!0))}function l(){k=!0,a()}var s=t.google,p=t.gapi,k=!1,g={docs:s.picker.ViewId.DOCS,docs_images:s.picker.ViewId.DOCS_IMAGES,documents:s.picker.ViewId.DOCUMENTS,presentations:s.picker.ViewId.PRESENTATIONS,spreadsheets:s.picker.ViewId.SPREADSHEETS,forms:s.picker.ViewId.FORMS,docs_images_and_videos:s.picker.ViewId.DOCS_IMAGES_AND_VIDEOS,docs_videos:s.picker.ViewId.DOCS_VIDEOS,folders:s.picker.ViewId.FOLDERS,pdfs:s.picker.ViewId.PDFS};r.on("click",function(){return k&&i.getAuthToken()?void a():i.getAuthToken()?void(k||p.load("picker",{callback:l})):void i.authorize(!1,o,function(e){e&&p.load("picker",{callback:l})})})}var u=e[0],d=a.viewId||"docs";i.isApiLoaded()?l():i.loadApi(function(){i.authorize(!0,o,function(){t.gapi.load("picker",{callback:l})})})}}}])}(RiseVision),function(){try{app=angular.module("risevision.widget.common.google-drive-picker")}catch(e){app=angular.module("risevision.widget.common.google-drive-picker",[])}app.run(["$templateCache",function(e){"use strict";e.put("google-drive-picker-template.html",'<button type="button" class="btn btn-google-drive"></button>\n')}])}();