function handleClientJSLoad(){isClientJS=!0;var e=document.createEvent("Events");e.initEvent("gapi.loaded",!0,!0),window.dispatchEvent(e)}!function(e){"use strict";e.module("risevision.widget.common.google-drive-picker",["risevision.common.i18n"]).directive("googleDrivePicker",["$window","$document","$log","$templateCache","apiAuth","apiGooglePicker",function(e,o,t,i,n,r){return{restrict:"E",scope:{viewId:"@"},template:i.get("google-drive-picker-template.html"),link:function(i,c,a){function u(e){r.get().then(function(o){e[o.picker.Response.ACTION]===o.picker.Action.PICKED?(t.debug("Files picked",e[o.picker.Response.DOCUMENTS]),i.$emit("picked",e[o.picker.Response.DOCUMENTS])):e[o.picker.Response.ACTION]===o.picker.Action.CANCEL&&(t.debug("File pick cancelled"),i.$emit("cancel"))})}function l(o){var t,i,r=s.createElement("a");s.referrer?"localhost"===s.location.hostname?t=e.location.protocol+"//"+e.location.host:(r.href=s.referrer,t=r.protocol+"//"+r.hostname):t=e.location.protocol+"//"+e.location.host,i=(new o.picker.PickerBuilder).setOrigin(t).addView(d).setOAuthToken(n.getAuthToken()).setCallback(u).build(),i.setVisible(!0)}var s=o[0],d=a.viewId||"docs";c.on("click",function(){n.getAuthToken()?r.get().then(l):n.getAuthToken()||n.authorize(!1).then(function(e){e&&!e.error&&r.get().then(l)})}),n.authorize(!0).then(null,function(e){t.warn(e)})}}}])}(angular);var isClientJS=!1;!function(e){"use strict";e.module("risevision.widget.common.google-drive-picker").factory("oauthAPILoader",["$q","$log","gapiLoader",function(e,o,t){var i,n=e.defer(),r={get:function(){return i||(i=n.promise,t.get().then(function(e){e.load("auth",function(){o.info("auth API is loaded"),n.resolve(e)})})),i}};return r}]).factory("gapiLoader",["$q","$window",function(e,o){var t={get:function(){var t,i=e.defer();return o.isClientJS?i.resolve(o.gapi):(t=function(){i.resolve(o.gapi),o.removeEventListener("gapi.loaded",t,!1)},o.addEventListener("gapi.loaded",t,!1)),i.promise}};return t}]).factory("pickerLoader",["$q","$window","$log","gapiLoader",function(e,o,t,i){var n={get:function(){var o,n=e.defer();return o||(o=n.promise,i.get().then(function(e){e.load("picker",function(){t.info("picker API is loaded"),n.resolve(e)})})),o}};return n}])}(angular),function(e){"use strict";e.module("risevision.widget.common.google-drive-picker").value("CLIENT_ID","614513768474-s4mo41canhfo0pco4pstn8m5v78kf5lv.apps.googleusercontent.com").value("SCOPE",["https://www.googleapis.com/auth/drive.readonly"]).factory("apiAuth",["$q","$http","$log","gapiLoader","oauthAPILoader","CLIENT_ID","SCOPE",function(e,o,t,i,n,r,c){var a=null,u={};return u.authorize=function(o){var i=e.defer(),u={client_id:r,scope:c,immediate:o};return n.get().then(function(e){e.auth.authorize(u,function(e){e&&!e.error?(a=e.access_token,i.resolve(e)):(i.reject("Authentication Error: "+e.error),t.debug("authorize result",e))})}),i.promise},u.getAuthToken=function(){return a},u}])}(angular),function(e){"use strict";e.module("risevision.widget.common.google-drive-picker").factory("apiGooglePicker",["$q","$window","$log","pickerLoader",function(e,o,t,i){var n,r=e.defer(),c={get:function(){return n||(n=r.promise,i.get().then(function(){r.resolve(o.google)})),n}};return c}])}(angular);